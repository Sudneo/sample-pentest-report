global !p
def choice(string, choices):
    if string:
        choices = [s[len(string):] for s in choices if s.startswith(string)]
    if len(choices) == 1:
        return choices[0]
    else:
        return "(" + '|'.join(choices) + ")"
endglobal

snippet findingsec "Section for a Finding"
	
	% Subsection for finding $1

	\subsection{${1:Name} (${2:Critical/High/Moderate/Low/Informational})}
	
	\begin{table}[htpb]
	    \centering
	    \begin{tabular}{|p{3cm}|p{9cm}|}
		\hline
		\cellcolor{heading-grey}\textbf{Description:} &
		% Description ---
		${4:Description} \\\\ \hline
		% ---------------
		\cellcolor{heading-grey}\textbf{Impact:} & \cellcolor{$2}$2 \\\\ \hline
		\cellcolor{heading-grey} \textbf{System:} &
		% Affected Systems ---
		${5:SYSTEMS} \\\\ \hline
		% --------------------
		\cellcolor{heading-grey} \textbf{References:} & 
		% References ---
		${6:References} \\\\ \hline
		% --------------
	    \end{tabular}
	\end{table}

	\subsubsection{Exploitation Proof of Concept}%
	% PoC text ---
	${7:PoC Text}
	% ------------
	
	\subsubsection{Remediation}

	\begin{longtable}[htpb]{|p{2cm}|p{12cm}|}
	    \hline
	    \cellcolor{dark-green}\textbf{Who:} & 
	    % Responsible Team ---
	    ${8:Team} \\\\ \hline
	    % --------------------
	    \cellcolor{dark-green}\textbf{Vector:} &
	    % Vector ---
	    ${9:Local/Remote} \\\\ \hline
	    % ----------
	    \multicolumn{2}{|l|}{\cellcolor{dark-green} \textbf{Actions:}} \\\\ \hline
	    % Actions ---
	    1 & ${10:ACTION1} \\\\ \hline
	    % -----------
	\end{longtable}
	\pagebreak

	$0
endsnippet

snippet findingseccolor "Section for a Finding with colored text"
	
	% Subsection for finding $1

	\subsection{\textcolor{$2}{${1:Name} (${2:Critical/High/Moderate/Low/Informational})}}
	
	\begin{table}[htpb]
	    \centering
	    \begin{tabular}{|p{3cm}|p{9cm}|}
		\hline
		\cellcolor{heading-grey}\textbf{Description:} &
		% Description ---
		${4:Description} \\\\ \hline
		% ---------------
		\cellcolor{heading-grey}\textbf{Impact:} & \cellcolor{$2}$2 \\\\ \hline
		\cellcolor{heading-grey} \textbf{System:} &
		% Affected Systems ---
		${5:SYSTEMS} \\\\ \hline
		% --------------------
		\cellcolor{heading-grey} \textbf{References:} & 
		% References ---
		${6:References} \\\\ \hline
		% --------------
	    \end{tabular}
	\end{table}

	\subsubsection{Exploitation Proof of Concept}%
	% PoC text ---
	${7:PoC Text}
	% ------------
	
	\subsubsection{Remediation}

	\begin{longtable}[htpb]{|p{2cm}|p{12cm}|}
	    \hline
	    \cellcolor{dark-green}\textbf{Who:} & 
	    % Responsible Team ---
	    ${8:Team} \\\\ \hline
	    % --------------------
	    \cellcolor{dark-green}\textbf{Vector:} &
	    % Vector ---
	    ${9:Local/Remote} \\\\ \hline
	    % ----------
	    \multicolumn{2}{|l|}{\cellcolor{dark-green} \textbf{Actions:}} \\\\ \hline
	    % Actions ---
	    1 & ${10:ACTION1} \\\\ \hline
	    % -----------
	\end{longtable}
	\pagebreak

	$0
endsnippet

snippet findingref "List of references (links)"
\begin{itemize}
    \item \href{${1:url}}{${2:link}} - ${3:description} 
\end{itemize}
endsnippet
